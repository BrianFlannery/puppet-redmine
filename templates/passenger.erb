# File Managed by Puppet
NameVirtualHost <%= @fqdn %>
<VirtualHost <%= @fqdn %>:80>
        LoadModule passenger_module <%= @install_dir %>/.rbenv/versions/<%= @ruby_version %>/lib/ruby/gems/1.9.1/gems/passenger-<%= @passenger_version %>/buildout/apache2/mod_passenger.so
        PassengerRoot <%= @install_dir %>/.rbenv/versions/<%= @ruby_version %>/lib/ruby/gems/1.9.1/gems/passenger-<%= @passenger_version %>
        PassengerDefaultRuby <%= @install_dir %>/.rbenv/versions/<%= @ruby_version %>/bin/ruby

        # you probably want to tune these settings
        PassengerHighPerformance on
        PassengerMaxPoolSize 12
        PassengerPoolIdleTime 1500
        # PassengerMaxRequests 1000
        PassengerStatThrottleRate 120

        RailsBaseURI /

#        SSLEngine on
#        SSLProtocol -ALL +SSLv3 +TLSv1
#        SSLCipherSuite ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:-LOW:-SSLv2:-EXP
#        SSLCertificateFile /etc/ssl/certs/<%= scope.lookupvar('hostname') %>.pem
#        SSLCertificateKeyFile /etc/ssl/private/<%= scope.lookupvar('hostname') %>.pem
#        SSLCertificateChainFile /etc/ssl/certs/ca.pem
#        SSLCACertificateFile /etc/ssl/certs/ca.pem

        DocumentRoot <%= @docroot %>
        <Directory <%= @docroot %>>
                Options None
                AllowOverride None
                Order allow,deny
                allow from all
        </Directory>

        LogLevel warn
        ErrorLog <%= scope.lookupvar('apache::params::log_dir') %>/<%= @fqdn %>_error.log
        CustomLog <%= scope.lookupvar('apache::params::log_dir') %>/<%= @fqdn %>_access.log combined
</VirtualHost>
